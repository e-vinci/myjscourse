{"version":3,"sources":["webpack://myjscourse/./src/components/content-editable/content-editable.js","webpack://myjscourse/./src/components/context/reviews/review-data-context.js","webpack://myjscourse/./src/components/reviews/my-reviews-summary.js","webpack://myjscourse/./src/components/reviews/project-reviews-summary.js","webpack://myjscourse/./src/components/quote/quote.js","webpack://myjscourse/./src/components/reviews/review-card.js","webpack://myjscourse/./src/components/spinner/spinner.js","webpack://myjscourse/./src/utils/string/string.js"],"names":["currentContent","allClasses","className","isBeingEdited","onChange","startContent","id","isInline","children","useState","content","he","contentEditable","onInput","e","propUpdated","currentTarget","textContent","suppressContentEditableWarning","ReviewDataContext","React","ReviewDataProvider","undefined","myReviewSummaryData","setMyReviewSummaryData","allReviewsData","setAllReviewsData","myReviewsData","setMyReviewsData","isLoaded","setIsLoaded","Provider","value","updateOperationCount","useReviewData","useContext","updateMyReviewSummaryData","userName","projectGroupName","callAPI","getIdToken","myReviewSummary","console","error","updateMyReviewsData","myReviews","updateAllReviewsData","allReviews","updateExpectedProjectReview","data","reviewUpdated","createFreeProjectReview","projectId","newReview","myReviewsSummary","icon","faHeart","availableLike","faComment","expectedReviews","alreadyReviewed","project","countLiked","countExpected","countReviews","author","userReview","setFilteredContents","getUserName","praise","projectReviews","length","find","element","setIsBeingEdited","like","setLike","projectUpdateState","setProjectUpdateState","isDetailed","setIsDetailed","detailedElementRef","useRef","userData","useProjectData","onProjectSave","Object","keys","notImpressed","_id","updatedProject","handleChange","propChanged","previousState","ref","shortId","name","projectMembers","includes","faCommentDots","onClick","faSave","faTimes","faEye","current","scrollIntoView","behavior","faMinusCircle","faCheckCircle","faTimesCircle","description","presentationUrl","src","frontendProductionUrl","href","target","frontendRepo","backendRepo","map","member","getNamesFromEmail","join","type","checked","disabled","review","index","faSpinner","email","names","substring","indexOf","firstname","lastname","charAt","toUpperCase","slice"],"mappings":"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","file":"9d92d307e8f824a8549e6192aa2e0178007be8e8-14641ddaecaeddecb0e3.js","sourcesContent":["import React, { useState } from \"react\";\r\nimport he from \"he\";\r\n\r\n/**\r\n * Make a div editable with text (could also be some HTML if needed).\r\n * @param {startContent} String to be used when the content is being updated\r\n * @param {children} React elements to be used when the content is not being updated\r\n * @returns\r\n */\r\n\r\nconst ContentEditable = ({\r\n  className,\r\n  isBeingEdited,\r\n  onChange,\r\n  startContent,\r\n  id,\r\n  isInline,\r\n  children,\r\n}) => {\r\n  const [content, setContent] = useState(startContent);\r\n\r\n  const handleChange = (e) => {\r\n    const propUpdated = {};\r\n    propUpdated[id] = e.currentTarget.textContent;\r\n    // set state at parent level\r\n    onChange(propUpdated);\r\n  };\r\n\r\n  let currentContent;\r\n  if (isBeingEdited) currentContent = content;\r\n  else if (children) currentContent = children;\r\n  else if (content) currentContent = he.decode(content);\r\n\r\n  let allClasses;\r\n  allClasses = className ? className : \"\";\r\n  if (isBeingEdited)\r\n    allClasses += \" index__card__content__description--is-being-edited\";\r\n  if (isInline) allClasses += \" index__card__content__description--is-inline\";\r\n\r\n  return (\r\n    <div\r\n      className={allClasses}\r\n      contentEditable={isBeingEdited ? true : false}\r\n      onInput={handleChange}\r\n      suppressContentEditableWarning={true}\r\n    >\r\n      {currentContent}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ContentEditable;\r\n","import React, { useContext, useState } from \"react\";\r\nimport callAPI from \"../../../utils/api/fetch\";\r\nimport { getIdToken } from \"../../../utils/auths/authPopup\";\r\n\r\nconst ReviewDataContext = React.createContext([\r\n  {},\r\n  () => {},\r\n  {},\r\n  () => {},\r\n  false, // isLoaded = false by default\r\n  () => {},\r\n]);\r\n\r\nconst ReviewDataProvider = ({ children }) => {\r\n  const [myReviewSummaryData, setMyReviewSummaryData] = useState(undefined);\r\n  const [allReviewsData, setAllReviewsData] = useState(undefined);\r\n  const [myReviewsData, setMyReviewsData] = useState(undefined);\r\n  const [isLoaded, setIsLoaded] = useState(false);\r\n\r\n  return (\r\n    <ReviewDataContext.Provider\r\n      value={[\r\n        myReviewSummaryData,\r\n        setMyReviewSummaryData,\r\n        allReviewsData,\r\n        setAllReviewsData,\r\n        myReviewsData,\r\n        setMyReviewsData,\r\n        isLoaded,\r\n        setIsLoaded,\r\n      ]}\r\n    >\r\n      {children}\r\n    </ReviewDataContext.Provider>\r\n  );\r\n};\r\n\r\nlet updateOperationCount = 0;\r\n\r\nconst useReviewData = () => {\r\n  const [\r\n    myReviewSummaryData,\r\n    setMyReviewSummaryData,\r\n    allReviewsData,\r\n    setAllReviewsData,\r\n    myReviewsData,\r\n    setMyReviewsData,\r\n    isLoaded,\r\n    setIsLoaded,\r\n  ] = useContext(ReviewDataContext);\r\n\r\n  const updateMyReviewSummaryData = async (userName, projectGroupName) => {\r\n    try {\r\n      const myReviewSummary = await callAPI(\r\n        `reviews/users/${userName}/projectgroups/${projectGroupName}/count`,\r\n        \"get\",\r\n        getIdToken(),\r\n        undefined\r\n      );\r\n      setMyReviewSummaryData(myReviewSummary);\r\n\r\n      return myReviewSummary;\r\n    } catch (err) {\r\n      console.error(\"useReviewData:updateMyReviewSummaryData:error:\", err);\r\n    }\r\n  };\r\n\r\n  const updateMyReviewsData = async (userName, projectGroupName) => {\r\n    try {\r\n      if (updateOperationCount === 0) setIsLoaded(false);\r\n      updateOperationCount++;\r\n      const myReviews = await callAPI(\r\n        `reviews/users/${userName}/projectgroups/${projectGroupName}`,\r\n        \"get\",\r\n        getIdToken(),\r\n        undefined\r\n      );\r\n      setMyReviewsData(myReviews);\r\n      updateOperationCount--;\r\n      if (updateOperationCount === 0) setIsLoaded(true);\r\n      return myReviews;\r\n    } catch (err) {\r\n      console.error(\"useReviewData:updateMyReviewsData:error:\", err);\r\n    }\r\n  };\r\n\r\n  const updateAllReviewsData = async (projectGroupName) => {\r\n    try {\r\n      if (updateOperationCount === 0) setIsLoaded(false);\r\n      updateOperationCount++;\r\n      const allReviews = await callAPI(\r\n        `reviews/projectgroups/${projectGroupName}/summary`,\r\n        \"get\",\r\n        getIdToken(),\r\n        undefined\r\n      );\r\n      setAllReviewsData(allReviews);\r\n      updateOperationCount--;\r\n      if (updateOperationCount === 0) setIsLoaded(true);\r\n      return allReviews;\r\n    } catch (err) {\r\n      console.error(\"useReviewData:updateAllReviewsData:error:\", err);\r\n    }\r\n  };\r\n\r\n  const updateExpectedProjectReview = async (data, id) => {\r\n    try {\r\n      const reviewUpdated = await callAPI(\r\n        \"reviews/\" + id,\r\n        \"PATCH\",\r\n        getIdToken(),\r\n        data\r\n      );\r\n\r\n      return reviewUpdated;\r\n    } catch (err) {\r\n      console.error(\"useReviewData:updateProjectReview:error:\", err);\r\n    }\r\n  };\r\n\r\n  const createFreeProjectReview = async (data, id) => {\r\n    try {\r\n      const newReview = await callAPI(\"reviews\", \"POST\", getIdToken(), {\r\n        ...data,\r\n        projectId: id,\r\n      });\r\n\r\n      return newReview;\r\n    } catch (err) {\r\n      console.error(\"useReviewData:createFreeProjectReview:error:\", err);\r\n    }\r\n  };\r\n\r\n  return {\r\n    ...{\r\n      myReviewSummaryData,\r\n      updateMyReviewSummaryData,\r\n      allReviewsData,\r\n      updateAllReviewsData,\r\n      myReviewsData,\r\n      updateMyReviewsData,\r\n      updateExpectedProjectReview,\r\n      createFreeProjectReview,\r\n      isLoaded,\r\n      setIsLoaded,\r\n    },\r\n  };\r\n};\r\n\r\nexport { ReviewDataProvider, useReviewData };\r\n","import React from \"react\";\r\nimport { Link, useStaticQuery } from \"gatsby\";\r\nimport YoutubeImage from \"../image/youtube-image.js\";\r\nimport ReviewCard from \"./review-card\";\r\nimport he from \"he\";\r\n\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faHeart, faComment } from \"@fortawesome/free-solid-svg-icons\";\r\n\r\nconst MyReviewsSummary = ({ myReviewsSummary }) => {\r\n  if (!myReviewsSummary) return null;\r\n\r\n \r\n\r\n  return (\r\n    <div className=\"card card--dark-summary card--fill-wrapper\">\r\n      <div className=\"card__header\">Résumé de mes revues</div>\r\n\r\n      <div className=\"card__content card__content--long-titles\">\r\n        <div className=\"card__content__title\">Coups de coeurs disponibles</div>\r\n        <div className=\"card__content__description\">\r\n          <FontAwesomeIcon icon={faHeart} />\r\n          <span className=\"text--light\">{myReviewsSummary.availableLike}</span>\r\n        </div>\r\n\r\n        <div className=\"card__content__title\">Revues attendues</div>\r\n        <div className=\"card__content__description\">\r\n          <FontAwesomeIcon icon={faComment} className=\"card__content--orange\"/>\r\n          <span className=\"text--light\">{myReviewsSummary.expectedReviews}</span>\r\n        </div>\r\n\r\n        <div className=\"card__content__title\">Revues terminées</div>\r\n        <div className=\"card__content__description\">\r\n          <FontAwesomeIcon icon={faComment} />\r\n          <span className=\"text--light\">{myReviewsSummary.alreadyReviewed}</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default MyReviewsSummary;\r\n","import React from \"react\";\r\n\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { faHeart, faComment } from \"@fortawesome/free-solid-svg-icons\";\r\n\r\nconst ProjectReviewsSummary = ({ project }) => {\r\n  if (!project) return null;\r\n\r\n  return (\r\n    <div className=\"counter\">\r\n      <div className=\"\">\r\n        <FontAwesomeIcon icon={faHeart} className=\"counter__symbol counter__symbol--red\" />\r\n        <span className=\"text--light\">{project.countLiked}</span>\r\n      </div>\r\n\r\n      <div className=\"\">\r\n        <FontAwesomeIcon icon={faComment} className=\"counter__symbol counter__symbol--orange\" />\r\n        <span className=\"text--light\">{project.countExpected}</span>\r\n      </div>\r\n\r\n      <div className=\"\">\r\n        <FontAwesomeIcon icon={faComment} className=\"counter__symbol counter__symbol--green\" />\r\n        <span className=\"text--light\">{project.countReviews}</span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ProjectReviewsSummary;\r\n","import React from \"react\";\r\nconst Quote = ({ content, author }) => {\r\n  return (\r\n    <div className=\"quote quote--close-to-others\">\r\n        <div className=\"quote__content quote__content--dark-and-wide\">\r\n      <q>{content}</q>\r\n      <br />\r\n      <i>\r\n        <small className=\"text--hand-written\">- {author}</small>\r\n      </i>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\nexport default Quote;\r\n\r\n\r\n/*\r\n\r\n<q>{content}</q>\r\n      <br />\r\n      <i>\r\n        <small className=\"text--hand-written\">- {author}</small>\r\n      </i>\r\n      */","import React, { useState, useRef, useEffect } from \"react\";\r\nimport YoutubeImage from \"../image/youtube-image.js\";\r\nimport he from \"he\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport {\r\n  faEye,\r\n  faMinusCircle,\r\n  faSave,\r\n  faTimes,\r\n  faCommentDots,\r\n  faTimesCircle,\r\n  faCheckCircle,\r\n} from \"@fortawesome/free-solid-svg-icons\";\r\nimport { getNamesFromEmail } from \"../../utils/string/string\";\r\nimport { useProjectData } from \"../context/projects/project-data-context\";\r\nimport ContentEditable from \"../content-editable/content-editable.js\";\r\nimport ProjectReviewsSummary from \"./project-reviews-summary.js\";\r\nimport { useReviewData } from \"../context/reviews/review-data-context.js\";\r\nimport { getUserName } from \"../../utils/auths/authPopup.js\";\r\nimport Quote from \"../quote/quote.js\";\r\n\r\nconst ReviewCard = ({ project, setFilteredContents }) => {\r\n  const userName = getUserName();\r\n  let userReview;\r\n  // get the associated review of the authenticated user (from my reviews)\r\n  if (project.praise) userReview = project;\r\n  // get the eventual associated review of the authenticated user (from all reviews)\r\n  else if (project.projectReviews && project.projectReviews.length > 0) {\r\n    userReview = project.projectReviews.find(\r\n      (element) => element.userName === userName\r\n    );\r\n  }\r\n\r\n  const [isBeingEdited, setIsBeingEdited] = useState(false);\r\n  const [like, setLike] = useState(userReview ? userReview.like : false);\r\n  const [projectUpdateState, setProjectUpdateState] = useState({});\r\n  const [isDetailed, setIsDetailed] = useState(false);\r\n\r\n  const detailedElementRef = useRef(null);\r\n\r\n  /*useEffect(() => {\r\n    console.log(\r\n      \"isDetailed\",\r\n      isDetailed,\r\n      \"Current\",\r\n      detailedElementRef.current\r\n    );\r\n\r\n    if (isDetailed) {\r\n      console.log(\"scroll into view please\");\r\n      detailedElementRef.current.scrollIntoView();\r\n    }\r\n  }, []);\r\n*/\r\n  // Get state management functions from the provider\r\n  const {\r\n    userData,\r\n    //projectGroupData,\r\n    //projectData,\r\n  } = useProjectData();\r\n\r\n  const {\r\n    updateExpectedProjectReview,\r\n    createFreeProjectReview,\r\n    updateAllReviewsData,\r\n    updateMyReviewSummaryData,\r\n    updateMyReviewsData,\r\n    myReviewSummaryData,\r\n  } = useReviewData();\r\n\r\n  // Deal with events\r\n\r\n  const onProjectUpdateRequest = () => {\r\n    setIsBeingEdited(true);\r\n  };\r\n\r\n  const onQuitProjectUpdateRequest = () => {\r\n    setIsBeingEdited(false);\r\n    // clear the update state\r\n    setProjectUpdateState({});\r\n  };\r\n\r\n  const onProjectSave = async () => {\r\n    /* save the updated state via the API only if :\r\n    the state object is not empty\r\n    each expected state property exists OR is given in the props*/\r\n    if (Object.keys(projectUpdateState).length === 0) return;\r\n\r\n    if (!projectUpdateState.praise && (!userReview || !userReview.praise))\r\n      return;\r\n\r\n    if (\r\n      !projectUpdateState.notImpressed &&\r\n      (!userReview || !userReview.notImpressed)\r\n    )\r\n      return;\r\n\r\n    /*\r\n    Determine if it's the update of an expected review or if it is\r\n    the creation of a new review :\r\n    */\r\n\r\n    let updatedProject;\r\n    if (userReview) {\r\n      updatedProject = await updateExpectedProjectReview(\r\n        projectUpdateState,\r\n        userReview._id\r\n      );\r\n    } else {\r\n      updatedProject = await createFreeProjectReview(\r\n        projectUpdateState,\r\n        project._id\r\n      );\r\n    }\r\n    // clear the project update state\r\n    setProjectUpdateState({});\r\n    setIsBeingEdited(false);\r\n    // update all review state to re-render\r\n    if (updatedProject) {\r\n      await updateAllReviewsData(project.projectGroupName);\r\n      await updateMyReviewSummaryData(\r\n        userData.userName,\r\n        project.projectGroupName\r\n      );\r\n      await updateMyReviewsData(userData.userName, project.projectGroupName);\r\n      setFilteredContents(undefined);\r\n    }\r\n    // }\r\n  };\r\n\r\n  const onViewDetails = () => {\r\n    setIsDetailed(true);\r\n    // Scroll to the element that is detailed\r\n    detailedElementRef.current.scrollIntoView({\r\n      behavior: \"smooth\",\r\n    });\r\n  };\r\n\r\n  const onQuitViewDetails = () => {\r\n    setIsDetailed(false);\r\n    // Scroll to the element that is left (no more detailed)\r\n    detailedElementRef.current.scrollIntoView({\r\n      behavior: \"smooth\",\r\n    });\r\n  };\r\n\r\n  // deal with modification of content\r\n  const handleChange = (propChanged) => {\r\n    // update the projectState\r\n    setProjectUpdateState((previousState) => {\r\n      return { ...previousState, ...propChanged };\r\n    });\r\n  };\r\n\r\n  const onSetLike = (e) => {\r\n    setLike(!like);\r\n    setProjectUpdateState({\r\n      ...projectUpdateState,\r\n      ...{ like: !like },\r\n    });\r\n  };\r\n\r\n  if (!project) return null;\r\n\r\n  return (\r\n    <div\r\n      className={\r\n        \"index__card\" +\r\n        (isBeingEdited\r\n          ? \" index__card--is-being-edited\"\r\n          : \"\" + (isDetailed ? \" index--long-text\" : \"\"))\r\n      }\r\n      ref={detailedElementRef}\r\n    >\r\n      <div className=\"index__card__header\">\r\n        <span>{\"Projet N° \" + project.shortId + \" : \" + project.name}</span>\r\n      </div>\r\n\r\n      <div className=\"index__card__header\">\r\n        <ProjectReviewsSummary project={project} />\r\n      </div>\r\n\r\n      <div className=\"index__card__description\">\r\n        {\r\n          /* ADD REVIEW : visible only if         \r\n          the username is not part of the projectMembers AND\r\n          the review is not being edited    AND\r\n          the review is not detailed                \r\n          */\r\n\r\n          !project.projectMembers.includes(userName) &&\r\n          !isBeingEdited &&\r\n          !isDetailed ? (\r\n            <FontAwesomeIcon\r\n              icon={faCommentDots}\r\n              onClick={onProjectUpdateRequest}\r\n            />\r\n          ) : (\r\n            \"\"\r\n          )\r\n        }\r\n\r\n        {\r\n          /*SAVE PROJECT : Visible only if :\r\n        project is being edited       \r\n        */\r\n          isBeingEdited && (\r\n            <FontAwesomeIcon icon={faSave} onClick={onProjectSave} />\r\n          )\r\n        }\r\n\r\n        {\r\n          /*QUIT PROJECT UPDATE: Visible only if :\r\n        project is being edited       \r\n        */\r\n          isBeingEdited && (\r\n            <FontAwesomeIcon\r\n              icon={faTimes}\r\n              onClick={onQuitProjectUpdateRequest}\r\n            />\r\n          )\r\n        }\r\n\r\n        {\r\n          /*VIEW PROJECT REVIEWS DETAILED : Visible only if :\r\n        project is not being edited AND\r\n        project is not detailed AND \r\n        the user has no more expected reviews    \r\n        */\r\n          !isBeingEdited &&\r\n            !isDetailed &&\r\n            myReviewSummaryData &&\r\n            myReviewSummaryData.expectedReviews === 0 && (\r\n              <FontAwesomeIcon icon={faEye} onClick={onViewDetails} />\r\n            )\r\n        }\r\n\r\n        {\r\n          /*QUIT PROJECT REVIEWS DETAILED: Visible only if :\r\n        project is detailed      \r\n        */\r\n          isDetailed && (\r\n            <FontAwesomeIcon icon={faTimes} onClick={onQuitViewDetails} />\r\n          )\r\n        }\r\n      </div>\r\n\r\n      {/* Deal with telling if the project is reviewed. :\r\n        Tell that the review is impossible if the user is a member of this project */}\r\n\r\n      <div className=\"index__card__content\">\r\n        <div className=\"index__card__content__title\">Ma revue ?</div>\r\n        <div className=\"index__card__content__description\">\r\n          {project.projectMembers.includes(userName) ? (\r\n            <FontAwesomeIcon icon={faMinusCircle} />\r\n          ) : userReview ? (\r\n            <FontAwesomeIcon icon={faCheckCircle} />\r\n          ) : (\r\n            <FontAwesomeIcon icon={faTimesCircle} />\r\n          )}\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"index__card__content\">\r\n        {project.description !== undefined ? (\r\n          <>\r\n            <div className=\"index__card__content__title\">Description</div>\r\n            <div className=\"index__card__content__description\">\r\n              {project.description}\r\n            </div>\r\n          </>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"index__card__content\">\r\n        {project.presentationUrl !== undefined ? (\r\n          <>\r\n            <div className=\"index__card__content__title\">\r\n              Vidéo de présentation\r\n            </div>\r\n\r\n            <div className=\"index__card__content__description\">\r\n              <YoutubeImage src={project.presentationUrl} />\r\n            </div>\r\n          </>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"index__card__content\">\r\n        {project.frontendProductionUrl !== undefined ? (\r\n          <>\r\n            <div className=\"index__card__content__title\">URL du site</div>\r\n            <div className=\"index__card__content__description\">\r\n              <a href={project.frontendProductionUrl} target=\"_blank\">\r\n                {project.frontendProductionUrl}\r\n              </a>\r\n            </div>\r\n          </>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </div>\r\n\r\n      {/* Deals with praises : this shall be shown :\r\n      if the attribute exists OR\r\n      if the user is adding a review (equivalent to a project update) */}\r\n      <div className=\"index__card__content\">\r\n        {project.praise !== undefined || isBeingEdited ? (\r\n          <>\r\n            <div className=\"index__card__content__title\">Mes points forts</div>\r\n            <ContentEditable\r\n              className=\"index__card__content__description\"\r\n              isBeingEdited={isBeingEdited}\r\n              id=\"praise\"\r\n              startContent={userReview ? userReview.praise : \"\"}\r\n              onChange={handleChange}\r\n            />\r\n          </>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </div>\r\n\r\n      {/* Deals with notImpressed points : this shall be shown :\r\n      if the attribute exists OR\r\n      if the user is adding a review (equivalent to a project update) */}\r\n      <div className=\"index__card__content\">\r\n        {project.notImpressed !== undefined || isBeingEdited ? (\r\n          <>\r\n            <div className=\"index__card__content__title\">\r\n              Mes points d'amélioration\r\n            </div>\r\n            <ContentEditable\r\n              className=\"index__card__content__description\"\r\n              isBeingEdited={isBeingEdited}\r\n              id=\"notImpressed\"\r\n              startContent={userReview ? userReview.notImpressed : \"\"}\r\n              onChange={handleChange}\r\n            />\r\n          </>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"index__card__content\">\r\n        {project.frontendRepo !== undefined ? (\r\n          <>\r\n            <div className=\"index__card__content__title\">Repo frontend</div>\r\n\r\n            <div className=\"index__card__content__description\">\r\n              <a href={project.frontendRepo} target=\"_blank\">\r\n                {project.frontendRepo}\r\n              </a>\r\n            </div>\r\n          </>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </div>\r\n\r\n      <div className=\"index__card__content\">\r\n        {project.backendRepo !== undefined ? (\r\n          <>\r\n            <div className=\"index__card__content__title\">Repo backend</div>\r\n            <div className=\"index__card__content__description\">\r\n              <a href={project.backendRepo} target=\"_blank\">\r\n                {project.backendRepo}\r\n              </a>\r\n            </div>\r\n          </>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </div>\r\n\r\n      {/* Deal with project members : show only if :\r\n      there are project members AND \r\n      project review is detailed */}\r\n      <div className=\"index__card__content\">\r\n        {project.projectMembers !== undefined &&\r\n        project.projectMembers.length > 0 &&\r\n        isDetailed ? (\r\n          <>\r\n            <div className=\"index__card__content__title\">Membres du projet</div>\r\n            <div className=\"index__card__content__description\">\r\n              {project.projectMembers\r\n                .map((member) => getNamesFromEmail(member))\r\n                .join(\", \")}\r\n            </div>\r\n          </>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </div>\r\n\r\n      {/* Deal with Like \r\n      allow a Like to be edited from false to true (a heart cannot be removed) \r\n      only when the user has still like to be given\r\n      the state provides the info to ensure that we disable only when we load the component\r\n      (because we want to allow updating like prior to click on save)\r\n      NB : this shall be shown :\r\n      if the attribute exists OR\r\n      if the user is adding a review (equivalent to a project update) */}\r\n      <div className=\"index__card__content\">\r\n        {(project.like !== undefined) | isBeingEdited ? (\r\n          <>\r\n            <div className=\"index__card__content__title\">Favori ?</div>\r\n            <div className=\"index__card__content__description\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={like}\r\n                disabled={\r\n                  !isBeingEdited || myReviewSummaryData.availableLike === 0\r\n                    ? true\r\n                    : like && !projectUpdateState.like\r\n                    ? true\r\n                    : false\r\n                }\r\n                onClick={onSetLike}\r\n              />\r\n            </div>\r\n          </>\r\n        ) : (\r\n          \"\"\r\n        )}\r\n      </div>\r\n\r\n      {/* Deal with all praises : show only if :      \r\n      project review is detailed AND\r\n      there are user reviews for this project*/}\r\n\r\n      {isDetailed && project.projectReviews && project.projectReviews.length > 0\r\n        ? project.projectReviews.map((review, index) => (\r\n            <div className=\"index__card__content\">\r\n              <div className=\"index__card__content__title\">\r\n                {index === 0 ? \"Tous les points forts\" : \"\"}\r\n              </div>\r\n              <div className=\"index__card__content__description\">\r\n                <Quote\r\n                  content={review.praise}\r\n                  author={getNamesFromEmail(review.userName)}\r\n                />\r\n              </div>\r\n            </div>\r\n          ))\r\n        : \"\"}\r\n\r\n      {/* Deal with all improvements : show only if :      \r\n      project review is detailed AND\r\n      there are user reviews for this project*/}\r\n\r\n      {isDetailed && project.projectReviews && project.projectReviews.length > 0\r\n        ? project.projectReviews.map((review, index) => (\r\n            <div className=\"index__card__content\">\r\n              <div className=\"index__card__content__title\">\r\n                {index === 0 ? \"Tous les points d'amélioration\" : \"\"}\r\n              </div>\r\n              <div className=\"index__card__content__description\">\r\n                <Quote\r\n                  content={review.notImpressed}\r\n                  author={getNamesFromEmail(review.userName)}\r\n                />\r\n              </div>\r\n            </div>\r\n          ))\r\n        : \"\"}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default ReviewCard;\r\n","import React from \"react\";\r\nimport { FontAwesomeIcon } from \"@fortawesome/react-fontawesome\";\r\nimport { fas, faSpinner } from \"@fortawesome/free-solid-svg-icons\";\r\n\r\nconst Spinner = () => {\r\n  return (\r\n    <div className=\"spinner\">\r\n      <div className=\"spinner__overlay\"></div>\r\n      <div className=\"spinner__animation\">\r\n        <FontAwesomeIcon icon={faSpinner} className=\"fa-3x fa-spin\" />\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Spinner;\r\n","const getNamesFromEmail = (email) => {\r\n  let names = email.substring(0, email.indexOf(\"@\"));\r\n  let firstname = names.substring(0, names.indexOf(\".\"));\r\n  let lastname = names.substring(names.indexOf(\".\") + 1);\r\n  firstname = firstname.charAt(0).toUpperCase() + firstname.slice(1);\r\n  lastname = lastname.charAt(0).toUpperCase() + lastname.slice(1);\r\n  // deal with cases where Extra info is added to the name, when there is a second dot\r\n  if (lastname.indexOf(\".\") >= 0) {\r\n    lastname = lastname.substring(lastname.indexOf(\".\") + 1);\r\n    lastname = lastname.charAt(0).toUpperCase() + lastname.slice(1);\r\n  }\r\n  return firstname + \" \" + lastname;\r\n};\r\n\r\nexport { getNamesFromEmail };\r\n"],"sourceRoot":""}